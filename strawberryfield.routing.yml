system.admin_config_strawberryfield:
  path: '/admin/config/archipelago'
  defaults:
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
    _title: 'Archipelago'
  requirements:
    _permission: 'access administration pages'
  options:
    _admin_route: TRUE

strawberryfield.important_solr_settings_form:
  path: '/admin/config/archipelago/important-solr-settings'
  defaults:
    _form: '\Drupal\strawberryfield\Form\ImportantSolrSettingsForm'
    _title: 'Important Solr Settings'
  requirements:
    _permission: 'access administration pages'
  options:
    _admin_route: TRUE

strawberryfield.file_persister_settings_form:
  path: '/admin/config/archipelago/filepersisting'
  defaults:
    _form: '\Drupal\strawberryfield\Form\FilePersisterServiceSettingsForm'
    _title: 'File Persister Service Settings'
  requirements:
    _permission: 'access administration pages'
  options:
    _admin_route: TRUE

strawberryfield.hydroponics_settings_form:
  path: '/admin/config/archipelago/hydroponics'
  defaults:
    _form: '\Drupal\strawberryfield\Form\HydroponicsSettingsForm'
    _title: 'Background Queue Processing Manager'
  requirements:
    _permission: 'access administration pages'
  options:
    _admin_route: TRUE

strawberryfield.multiple_patch_confirm:
  path: '/admin/config/archipelago/actions/jsonpatch'
  defaults:
    _form: '\Drupal\strawberryfield\Form\JsonPatchMultiple'
  requirements:
    _permission: 'JSON Patch Strawberryfield'

# The access check below has a soft dependency on Form Mode Manager module
# We get a list of all form modes, then check if user has permissions "use <formmode> form mode"
# These permissions are generated by Form Mode Manager
# See \Drupal\strawberryfield\Controller\CustomNodeEditController::getActiveFormModes
strawberryfield.custom_node_edit:
  path: '/node/{node}/edit-node'
  defaults:
     _controller: '\Drupal\strawberryfield\Controller\CustomNodeEditController::redirectToForm'
  requirements:
    _custom_access: '\Drupal\strawberryfield\Controller\CustomNodeEditController::access'
  options:
    parameters:
      node:
        type: entity:node

# Search Highlight Endpoint for a given Node file uuid and processor.
strawberryfield.flavor_datasource_search:
  path: '/do/{node}/flavorsearch/{fileuuid}/{processor}'
  methods: [GET]
  defaults:
    _controller: '\Drupal\strawberryfield\Controller\StrawberryfieldFlavorDatasourceSearchController::search'
  options:
    no_cache: TRUE
    parameters:
      node:
        type: 'entity:node'
      resource_type:
        type: 'ado'
      fileuuid: 'all'
  requirements:
    fileuuid: .+
    processor: .+
    _entity_access: 'node.view'

# Count of Solr docs given Node and a processor.
strawberryfield.flavor_datasource_count:
  path: '/do/{node}/flavorcount/{processor}'
  methods: [GET]
  defaults:
    _controller: '\Drupal\strawberryfield\Controller\StrawberryfieldFlavorDatasourceSearchController::count'
  options:
    no_cache: TRUE
    parameters:
      node:
        type: 'entity:node'
      resource_type:
        type: 'ado'
  requirements:
    processor: .+
    _entity_access: 'node.view'
